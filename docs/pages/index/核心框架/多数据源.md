<!--
 * @Author: wangzhichiao<https://github.com/wzc570738205>
 * @Date: 2020-12-04 12:43:07
 * @LastEditors: wangzhichiao<https://github.com/wzc570738205>
 * @LastEditTime: 2020-12-04 14:25:02
-->
## 插件介绍
多数据源通过注解配置方式，给业务方法提供除主数据源外，从数据源的支持。
## 使用说明

该datasource的配置使用于一主一从类型的数据源，主数据源可读写，从数据源只读。使用方法有两种：
1、使用注解：在方法上使用@DS("master")表示使用主库，使用@DS("其他的dataSource")表示使用【其他的dataSource】库；
2、使用事务：在方法上不加@DS，但是加上@Transiactional则会在master库中创建事务；

说明master库是指spring.datasource下的库
其他库是指用户在自己的config下读取配置生成的数据库

## 配置步骤

1. 引入依赖（需指定pom中parent为framework-core/framework-cloud，或者指定下面dependency的版本号1.0.0）:

<dependency>
    <groupId>com.ichinae.core.plugins</groupId>
    <artifactId>ichinae-core-plugins-datasource</artifactId>
</dependency>

2. 在启动类上添加：
```
@SpringBootApplication(scanBasePackages = {"com.ichinae.plugins.datasource"})
@SpringBootApplication(exclude = {DataSourceAutoConfiguration.class})//此句避免出现循环依赖
```
3. 添加配置信息如下：
```
### 多数据源配置，读写分离
spring:
  datasource:
    url: jdbc:mysql://192.168.60.195:3306/test?characterEncoding=UTF-8&serverTimezone=Asia/Shanghai
    username: root
    password: root
    driver-class-name: com.mysql.cj.jdbc.Driver
  datasource1:
    slave:
      url: jdbc:mysql://192.168.60.195:3306/test1?characterEncoding=UTF-8&serverTimezone=Asia/Shanghai
      username: root
      password: root
      driver-class-name: com.mysql.cj.jdbc.Driver

```

4. 增加数据库配置：
多数据源配置，读写分离
```
@Configuration
public class SqlConfiguration {

    @Bean(name = "slaveDataSource")
    @ConfigurationProperties("spring.datasource1.slave")
    public DataSource masterDataSource() {
        return new DruidDataSource();
    }
}
```