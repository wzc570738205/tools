(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{401:function(t,e,s){"use strict";s.r(e);var n=s(45),a=Object(n.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("欢迎加入前端交流群："),s("a",{attrs:{href:"//shang.qq.com/wpa/qunwpa?idkey=f528775f242a7c39fe8512383febb8990e621bf97354c2fb82f6832097b7c501"}},[t._v("749539640")])]),t._v(" "),s("p",[t._v("svn其实也和github一样有自己的钩子，我们先看下效果")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/Wzhichao/img/raw/master/uPic/LvGpOP59%20.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"钉钉机器人配置-webhook生成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#钉钉机器人配置-webhook生成"}},[t._v("#")]),t._v(" 钉钉机器人配置（webhook生成）")]),t._v(" "),s("blockquote",[s("p",[t._v("设置=>添加机器人")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/Wzhichao/img/raw/master/uPic/nZFDbj40%20.png",alt:""}})]),t._v(" "),s("blockquote",[s("p",[t._v("添加自定义机器人，这里的关键词添加"),s("code",[t._v("#")]),t._v("即可")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/Wzhichao/img/raw/master/uPic/J4KTp031%20.png",alt:""}})]),t._v(" "),s("p",[t._v("复制webhook")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/Wzhichao/img/raw/master/uPic/Dj1ANe58%20.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"svn设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#svn设置"}},[t._v("#")]),t._v(" svn设置")]),t._v(" "),s("p",[t._v("我们进入到svn的服务器代码目录，会看到有个hooks的文件夹")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/Wzhichao/img/raw/master/uPic/vHYxvF27%20.png",alt:""}})]),t._v(" "),s("p",[t._v("目前svn提供了5个hooks，今天我们只介绍"),s("code",[t._v("post-commit")]),s("a",{attrs:{href:"https://www.kancloud.cn/i281151/svn/197125",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("它在事务完成后运行，创建一个新的修订版本。大多数人用这个钩子来发送关于提交的描述性电子邮件，或者作为版本库的备份。版本库传给程序两个参数：到版本库的路径和被创建的新的修订版本号。退出程序会被忽略。")]),t._v(" "),s("p",[t._v("接下来我们进入hooks文件夹，执行")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("vim post-commit\n")])])]),s("p",[t._v("如果没有会自动新建此文件")]),t._v(" "),s("p",[t._v("键入代码")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('#!/bin/bash\n# svn中变量1为仓库路径，2为提交版本号\n\nREPOS="$1"\nREV="$2"\n\n# 设置默认字符集，否则post信息到钉钉时中文乱码\nexport LANG=en_US.UTF-8\n\n# 下方svnlook命令获取相应的结果\ntime=$(date +%F/%T)\nAUTHOR=$(/bin/svnlook author -r ${REV} ${REPOS})\nCHANGEDDIRS=$(/bin/svnlook dirs-changed $REPOS)\nMESSAGE=$(/bin/svnlook log -r $REV $REPOS)\n\nCONTENT=提交时间：${time}\\\\n提交版本：#${REV}\\\\n提交者：${AUTHOR}\\\\n提交备注：${MESSAGE}\\\\n修改目录：$CHANGEDDIRS\ncurl \'https://oapi.dingtalk.com/robot/send?access_token=这里输入你的webhooks的token\' \\\n   -H \'Content-Type: application/json\' \\\n   -d \'{"msgtype": "text",\n        "text": {\n             "content":"\'$CONTENT\'"\n        }\n      }\'\n')])])]),s("blockquote",[s("p",[t._v("我说一下之前钉钉webhoos生成时候安全设置的"),s("code",[t._v("#")]),t._v("号和上述代码中提交版本后的"),s("code",[t._v("#")]),t._v("对应了起来")])]),t._v(" "),s("p",[t._v("最后测试效果！每次提交代码都会触发postcommit hook自动推送信息到钉钉")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/Wzhichao/img/raw/master/uPic/LvGpOP59%20.png",alt:""}})])])}),[],!1,null,null,null);e.default=a.exports}}]);